<form #clientForm="ngForm" (ngSubmit)="onSubmit()">
  <div class="row">
    <div>
      <div class="col s12 m12">
        <div class="row">
          <h5 class="center">General informations</h5>
          <hr />
          <div class="col s12 m6">
            <!-- Clients -->
            <div class="form-input">
              <label for="client"
                >Client <span class="red-text">(*)</span></label
              >
              <select
                class="browser-default"
                name="client"
                id="client"
                [(ngModel)]="quotation.client"
                [compareWith]="compareClient"
                required
              >
                <option [ngValue]="null" disabled>Select client</option>
                <option *ngFor="let item of clients" [ngValue]="item">
                  {{ item.name }}
                </option>
              </select>
            </div>

            <!-- Quotation type -->
            <div class="form-input">
              <label for="type"
                >Quotation type <span class="red-text">(*)</span></label
              >
              <select
                class="browser-default"
                name="type"
                id="type"
                [(ngModel)]="quotation.type"
                [compareWith]="compareFn"
                (change)="selectedType()"
                [disabled]="!isAddForm"
                required
              >
                <option [ngValue]="null" disabled>Select type</option>
                <option *ngFor="let item of types" [ngValue]="item">
                  {{ item.type }}
                </option>
              </select>
            </div>
          </div>
          <div class="col s12 m6">
            <!-- Currencies -->
            <div class="form-input">
              <label for="currency"
                >Currency <span class="red-text">(*)</span></label
              >
              <select
                class="browser-default"
                name="currency"
                id="currency"
                [(ngModel)]="quotation.currency"
                [compareWith]="compareFn"
                required
              >
                <option [ngValue]="null" disabled>Select currency</option>
                <option *ngFor="let item of currencies" [ngValue]="item">
                  {{ item.value }}
                </option>
              </select>
            </div>

            <!-- Date of operation -->
            <div class="form-input">
              <label for="date_op"
                >Date operation <span class="red-text">(*)</span></label
              >
              <div class="input-field">
                <input
                  type="date"
                  class="form-control"
                  id="date_op"
                  name="date_op"
                  [(ngModel)]="quotation.date_op"
                  #date_op="ngModel"
                  required
                />
              </div>
            </div>
          </div>
        </div>
        <div
          class="row"
          *ngIf="quotation.type != null && quotation.type.type == 'Products'"
        >
          <h5 class="center">Products selection</h5>
          <hr />
          <div
            class="col m4 s12"
            style="border: 2px solid #757575; min-height: 100px"
          >
            <div class="form-input">
              <label for="product"
                >Product <span class="red-text">(*)</span></label
              >
              <select
                class="browser-default"
                name="product"
                id="product"
                [(ngModel)]="quotation_product.product"
                [compareWith]="compareFn"
              >
                <option [ngValue]="null" disabled>Select product</option>
                <option *ngFor="let item of filteredProducts" [ngValue]="item">
                  {{ item.name }}
                </option>
              </select>
            </div>
            <!-- Quantity -->
            <div class="form-input">
              <label for="quantity"
                >Quantity <span class="red-text">(*)</span></label
              >
              <div class="input-field">
                <input
                  type="number"
                  class="form-control"
                  id="quantity"
                  name="quantity"
                  [(ngModel)]="quotation_product.quantity"
                  #phone="ngModel"
                  min="0"
                />
              </div>
            </div>
            <!-- Unit price -->
            <div class="form-input">
              <label for="price">Price <span class="red-text">(*)</span></label>
              <div class="input-field">
                <input
                  type="number"
                  class="form-control"
                  id="price"
                  name="price"
                  min="0"
                  [(ngModel)]="quotation_product.unit_price"
                  #email="ngModel"
                />
              </div>
            </div>
            <div class="form-input">
              <label for="market_price"
                >Market Price <span class="red-text">(*)</span></label
              >
              <div class="input-field">
                <input
                  type="number"
                  class="form-control"
                  id="market_price"
                  name="market_price"
                  min="0"
                  [(ngModel)]="quotation_product.market_price"
                  #email="ngModel"
                />
              </div>
            </div>
          </div>
          <div class="col m2 s12">
            <button
              type="button"
              class="waves-effect waves-light btn btn-small brown darken-3"
              [disabled]="disabledAssignButton()"
              (click)="assignProduct()"
            >
              <i class="material-icons">compare_arrows</i>
              Assign
            </button>
          </div>
          <div
            class="col m6 s12"
            style="border: 2px solid #757575; min-height: 100px"
          >
            <h5 class="center">Ordered products</h5>
            <table>
              <thead class="center">
                <tr>
                  <th>Product</th>
                  <th>Quantity</th>
                  <th>Unit price</th>
                  <th></th>
                </tr>
              </thead>
              <tbody class="center">
                <tr *ngFor="let item of order_products_list">
                  <td>{{ item.product.name }}</td>
                  <td>{{ item.quantity }}</td>
                  <td>{{ item.unit_price }}</td>
                  <td>
                    <a
                      class="btn-flat red-text"
                      (click)="removeProductToList(item)"
                      ><i class="material-icons">delete_forever</i></a
                    >
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div
          class="row"
          *ngIf="quotation.type != null && quotation.type.type == 'Services'"
        >
          <h5 class="center">Services</h5>
          <hr />
          <div
            class="col m4 s12"
            style="border: 2px solid #757575; min-height: 100px"
          >
            <div class="form-input">
              <label for="service"
                >Service <span class="red-text">(*)</span></label
              >
              <div class="input-field">
                <input
                  type="text"
                  class="form-control"
                  id="service"
                  name="service"
                  min="0"
                  [(ngModel)]="quotation_service.service"
                  #email="ngModel"
                />
              </div>
            </div>
            <!-- Quantity -->
            <div class="form-input">
              <label for="quantity"
                >Quantity <span class="red-text">(*)</span></label
              >
              <div class="input-field">
                <input
                  type="number"
                  class="form-control"
                  id="quantity"
                  name="quantity"
                  [(ngModel)]="quotation_service.quantity"
                  #phone="ngModel"
                  min="0"
                />
              </div>
            </div>
            <!-- Unit price -->
            <div class="form-input">
              <label for="price">Price <span class="red-text">(*)</span></label>
              <div class="input-field">
                <input
                  type="number"
                  class="form-control"
                  id="price"
                  name="price"
                  min="0"
                  [(ngModel)]="quotation_service.unit_price"
                  #email="ngModel"
                />
              </div>
            </div>
          </div>
          <div class="col m2 s12">
            <button
              type="button"
              class="waves-effect waves-light btn btn-small brown darken-3"
              [disabled]="disabledAssignServiceButton()"
              (click)="assignService()"
            >
              <i class="material-icons">compare_arrows</i>
              Assign
            </button>
          </div>
          <div
            class="col m6 s12"
            style="border: 2px solid #757575; min-height: 100px"
          >
            <h5 class="center">Liste services</h5>
            <table>
              <thead class="center">
                <tr>
                  <th>Service</th>
                  <th>Quantity</th>
                  <th>Unit price</th>
                  <th></th>
                </tr>
              </thead>
              <tbody class="center">
                <tr *ngFor="let item of order_services_list">
                  <td>{{ item.service }}</td>
                  <td>{{ item.quantity }}</td>
                  <td>{{ item.unit_price }}</td>
                  <td>
                    <a
                      class="btn-flat red-text"
                      (click)="removeServiceToList(item)"
                      ><i class="material-icons">delete_forever</i></a
                    >
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="row">
          <h5 class="center">Extra information</h5>
          <hr />
          <div class="col m5 s12">
            <p>
              <label>
                <input
                  type="checkbox"
                  class="filled-in"
                  [checked]="isShipping"
                  (change)="stateCheckedBoxCustom($event)"
                />
                <span>Custom and transportation</span>
              </label>
            </p>
            <div class="form-input" *ngIf="isShipping">
              <label for="amount_custom"
                >Amount custom and transportation
                <span class="red-text">(*)</span></label
              >
              <div class="input-field">
                <input
                  type="number"
                  class="form-control"
                  id="amount_custom"
                  name="amount_custom"
                  min="0"
                  [(ngModel)]="quotation.delivery_amount"
                  #discount_percent="ngModel"
                  required
                />
              </div>
            </div>
            <br />
            <p>
              <label>
                <input
                  type="checkbox"
                  class="filled-in"
                  [checked]="isVAT"
                  (change)="stateCheckedBoxVat($event)"
                />
                <span>Add VAT (19.25%)</span>
              </label>
            </p>
            <br />
          </div>
          <div class="col m1 s12"></div>
          <div class="col m6 s12">
            <p>
              <label>
                <input
                  type="checkbox"
                  class="filled-in"
                  [checked]="isDiscount"
                  (change)="stateCheckedBoxDiscount($event)"
                />
                <span>Discount (%)</span>
              </label>
            </p>
            <div class="form-input" *ngIf="isDiscount">
              <label for="discount_percent"
                >Discount percentage <span class="red-text">(*)</span></label
              >
              <div class="input-field">
                <input
                  type="number"
                  class="form-control"
                  id="discount_percent"
                  name="discount_percent"
                  min="0"
                  [(ngModel)]="quotation.discount_percent"
                  #discount_percent="ngModel"
                  required
                />
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Submit button -->
      <div class="divider"></div>

      <div
        class="col s12 m12 center"
        *ngIf="quotation.type != null && quotation.type.type == 'Products'"
      >
        <hr />
        <button
          type="submit"
          *ngIf="isAddForm"
          class="waves-effect waves-light btn"
          [disabled]="!clientForm.form.valid || order_products_list.length == 0"
        >
          <i class="material-icons">save</i>
          Save
        </button>

        <button
          type="submit"
          *ngIf="!isAddForm"
          class="waves-effect waves-light btn"
          [disabled]="!clientForm.form.valid || order_products_list.length == 0"
        >
          Update
        </button>
      </div>

      <div
        class="col s12 m12 center"
        *ngIf="quotation.type != null && quotation.type.type == 'Services'"
      >
        <hr />
        <button
          type="submit"
          *ngIf="isAddForm"
          class="waves-effect waves-light btn"
          [disabled]="!clientForm.form.valid || order_services_list.length == 0"
        >
          <i class="material-icons">save</i>
          Save
        </button>

        <button
          type="submit"
          *ngIf="!isAddForm"
          class="waves-effect waves-light btn"
          [disabled]="!clientForm.form.valid || order_services_list.length == 0"
        >
          Update
        </button>
      </div>
    </div>
  </div>
</form>

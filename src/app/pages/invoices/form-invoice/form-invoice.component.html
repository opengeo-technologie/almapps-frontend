<form #clientForm="ngForm" (ngSubmit)="onSubmit()">
  <div class="row">
    <div>
      <div class="col s12 m12">
        <div class="row">
          <h5 class="center">General informations</h5>
          <hr />
          <div class="col s12 m6">
            <!-- Clients -->
            <div class="form-input">
              <label for="client"
                >Client <span class="red-text">(*)</span></label
              >
              <select
                class="browser-default"
                name="client"
                id="client"
                [(ngModel)]="invoice.client"
                [compareWith]="compareClient"
                required
              >
                <option [ngValue]="null" disabled>Select client</option>
                <option *ngFor="let item of clients" [ngValue]="item">
                  {{ item.name }}
                </option>
              </select>
            </div>

            <!-- Quotation type -->
            <div class="form-input">
              <label for="type"
                >Invoice type <span class="red-text">(*)</span></label
              >
              <select
                class="browser-default"
                name="type"
                id="type"
                [(ngModel)]="invoice.type"
                [compareWith]="compareFn"
                (change)="selectedType()"
                [disabled]="!isAddForm"
                required
              >
                <option [ngValue]="null" disabled>Select type</option>
                <option *ngFor="let item of types" [ngValue]="item">
                  {{ item.type }}
                </option>
              </select>
            </div>
          </div>
          <div class="col s12 m6">
            <!-- Currencies -->
            <div class="form-input">
              <label for="currency"
                >Currency <span class="red-text">(*)</span></label
              >
              <select
                class="browser-default"
                name="currency"
                id="currency"
                [(ngModel)]="invoice.currency"
                [compareWith]="compareFn"
                required
              >
                <option [ngValue]="null" disabled>Select currency</option>
                <option *ngFor="let item of currencies" [ngValue]="item">
                  {{ item.value }}
                </option>
              </select>
            </div>

            <!-- Date of operation -->
            <div class="form-input">
              <label for="date_op"
                >Date operation <span class="red-text">(*)</span></label
              >
              <div class="input-field">
                <input
                  type="date"
                  class="form-control"
                  id="date_op"
                  name="date_op"
                  [(ngModel)]="invoice.date_op"
                  #date_op="ngModel"
                  required
                />
              </div>
            </div>
          </div>
        </div>

        <!-- Jobs -->
        <div class="row" *ngIf="invoice.type != null && invoice.type.id == 1">
          <h5 class="center">Jobs</h5>
          <hr />
          <div
            class="col m4 s12"
            style="border: 2px solid #757575; min-height: 100px"
          >
            <div class="form-input">
              <label for="job_name"
                >Job label <span class="red-text">(*)</span></label
              >
              <div class="input-field">
                <input
                  type="text"
                  class="form-control"
                  id="job_name"
                  name="job_name"
                  [(ngModel)]="job.job_name"
                  #job_name="ngModel"
                />
              </div>
            </div>

            <div class="form-input">
              <label for="job_description"
                >Job description <span class="red-text">(*)</span></label
              >
              <div class="input-field">
                <input
                  type="text"
                  class="form-control"
                  id="job_description"
                  name="job_description"
                  [(ngModel)]="job.job_description"
                  #job_description="ngModel"
                />
              </div>
            </div>
            <!-- Price -->
            <div class="form-input">
              <label for="price">Price <span class="red-text">(*)</span></label>
              <div class="input-field">
                <input
                  type="number"
                  class="form-control"
                  id="price"
                  name="price"
                  min="0"
                  [(ngModel)]="job.price"
                  #price="ngModel"
                />
              </div>
            </div>

            <div class="form-input">
              <label for="duration"
                >Duration <span class="red-text">(*)</span></label
              >
              <div class="input-field">
                <input
                  type="number"
                  class="form-control"
                  id="duration"
                  name="duration"
                  min="0"
                  [(ngModel)]="job.duration"
                  #duration="ngModel"
                />
              </div>
            </div>
          </div>
          <div class="col m2 s12">
            <button
              type="button"
              class="waves-effect waves-light btn btn-small brown darken-3"
              [disabled]="disabledAssignJobButton()"
              (click)="assignJob()"
            >
              <i class="material-icons">compare_arrows</i>
              Assign
            </button>
          </div>
          <div
            class="col m6 s12"
            style="border: 2px solid #757575; min-height: 100px"
          >
            <h5 class="center">List of jobs</h5>
            <table>
              <thead class="center">
                <tr>
                  <th>Job</th>
                  <th>Price</th>
                  <th>Duration</th>
                  <th></th>
                </tr>
              </thead>
              <tbody class="center">
                <tr *ngFor="let item of jobs_list">
                  <td>{{ item.job_name }}</td>
                  <td>{{ item.price }}</td>
                  <td>{{ item.duration }}</td>
                  <td>
                    <a class="btn-flat red-text" (click)="removeJobToList(item)"
                      ><i class="material-icons">delete_forever</i></a
                    >
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Products -->
        <div class="row" *ngIf="invoice.type != null && invoice.type.id == 3">
          <h5 class="center">Products</h5>
          <hr />
          <div
            class="col m4 s12"
            style="border: 2px solid #757575; min-height: 100px"
          >
            <div class="form-input">
              <label for="product"
                >Product <span class="red-text">(*)</span></label
              >
              <select
                class="browser-default"
                name="product"
                id="product"
                [(ngModel)]="order_product.product"
                [compareWith]="compareFn"
              >
                <option [ngValue]="null" disabled>Select product</option>
                <option *ngFor="let item of filteredProducts" [ngValue]="item">
                  {{ item.name }}
                </option>
              </select>
            </div>

            <div class="form-input">
              <label for="quantity"
                >Quantity <span class="red-text">(*)</span></label
              >
              <div class="input-field">
                <input
                  type="number"
                  class="form-control"
                  id="quantity"
                  name="quantity"
                  min="0"
                  [(ngModel)]="order_product.quantity"
                  #quantity="ngModel"
                />
              </div>
            </div>
            <!-- Price -->
            <div class="form-input">
              <label for="unit_price"
                >Price <span class="red-text">(*)</span></label
              >
              <div class="input-field">
                <input
                  type="number"
                  class="form-control"
                  id="unit_price"
                  name="unit_price"
                  min="0"
                  [(ngModel)]="order_product.unit_price"
                  #unit_price="ngModel"
                />
              </div>
            </div>
          </div>
          <div class="col m2 s12">
            <button
              type="button"
              class="waves-effect waves-light btn btn-small brown darken-3"
              [disabled]="disabledAssignProductButton()"
              (click)="assignProduct()"
            >
              <i class="material-icons">compare_arrows</i>
              Assign
            </button>
          </div>
          <div
            class="col m6 s12"
            style="border: 2px solid #757575; min-height: 100px"
          >
            <h5 class="center">List of products</h5>
            <table>
              <thead class="center">
                <tr>
                  <th>product</th>
                  <th>quantity</th>
                  <th>unit price</th>
                  <th></th>
                </tr>
              </thead>
              <tbody class="center">
                <tr *ngFor="let item of order_products_list">
                  <td>{{ item.product.name }}</td>
                  <td>{{ item.quantity }}</td>
                  <td>{{ item.unit_price }}</td>
                  <td>
                    <a
                      class="btn-flat red-text"
                      (click)="removeProductToList(item)"
                      ><i class="material-icons">delete_forever</i></a
                    >
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Technicians -->
        <div class="row" *ngIf="invoice.type != null && invoice.type.id == 2">
          <h5 class="center">Technicians</h5>
          <hr />
          <div
            class="col m12 s12"
            style="border: 2px solid #757575; min-height: 100px"
          >
            <div class="form-input">
              <label for="technician"
                >Technician <span class="red-text">(*)</span></label
              >
              <select
                class="browser-default"
                name="technician"
                id="technician"
                [(ngModel)]="invoice_technicians.technician"
                [compareWith]="compareFn"
                #technician="ngModel"
              >
                <option [ngValue]="null" disabled>Select technician</option>
                <option
                  *ngFor="let item of filteredTechnicians"
                  [ngValue]="item"
                >
                  {{ item.name }}
                </option>
              </select>
            </div>
            <!-- Normal hours -->
            <div class="col m4 s12">
              <div class="form-input">
                <label for="normal_hour1"
                  >Normal hour 1 <span class="red-text">(*)</span></label
                >
                <div class="input-field">
                  <input
                    type="number"
                    class="form-control"
                    id="normal_hour1"
                    name="normal_hour1"
                    required
                    min="0"
                    [(ngModel)]="invoice_technicians.normal_hour1"
                    #normal_hour1="ngModel"
                  />
                </div>
              </div>
              <!-- Price -->
              <div class="form-input">
                <label for="normal_hour2">Normal hour 2</label>
                <div class="input-field">
                  <input
                    type="number"
                    class="form-control"
                    id="normal_hour2"
                    name="normal_hour2"
                    min="0"
                    [(ngModel)]="invoice_technicians.normal_hour2"
                    #normal_hour2="ngModel"
                  />
                </div>
              </div>
              <div class="form-input">
                <label for="normal_unit_price"
                  >Amount<span class="red-text">(*)</span></label
                >
                <div class="input-field">
                  <input
                    type="number"
                    class="form-control"
                    id="normal_unit_price"
                    name="normal_unit_price"
                    required
                    min="0"
                    [(ngModel)]="invoice_technicians.normal_unit_price"
                    #normal_unit_price="ngModel"
                  />
                </div>
              </div>
            </div>

            <!-- Overtime hours -->
            <div class="col m4 s12">
              <div class="form-input">
                <label for="overtime_hour1"
                  >Overtime hours 1 <span class="red-text">(*)</span></label
                >
                <div class="input-field">
                  <input
                    type="number"
                    class="form-control"
                    id="overtime_hour1"
                    name="overtime_hour1"
                    required
                    min="0"
                    [(ngModel)]="invoice_technicians.overtime_hour1"
                    #overtime_hour1="ngModel"
                  />
                </div>
              </div>
              <!-- Price -->
              <div class="form-input">
                <label for="overtime_hour2">Overtime hour 2</label>
                <div class="input-field">
                  <input
                    type="number"
                    class="form-control"
                    id="overtime_hour2"
                    name="overtime_hour2"
                    min="0"
                    [(ngModel)]="invoice_technicians.overtime_hour2"
                    #overtime_hour2="ngModel"
                  />
                </div>
              </div>
              <div class="form-input">
                <label for="overtime_unit_price"
                  >Amount<span class="red-text">(*)</span></label
                >
                <div class="input-field">
                  <input
                    type="number"
                    class="form-control"
                    id="overtime_unit_price"
                    name="overtime_unit_price"
                    required
                    min="0"
                    [(ngModel)]="invoice_technicians.overtime_unit_price"
                    #overtime_unit_price="ngModel"
                  />
                </div>
              </div>
            </div>

            <!-- Allowance -->
            <div class="col m4 s12">
              <div class="form-input">
                <label for="allowance_hour1"
                  >Allowance hours 1 <span class="red-text">(*)</span></label
                >
                <div class="input-field">
                  <input
                    type="number"
                    class="form-control"
                    id="allowance_hour1"
                    name="allowance_hour1"
                    required
                    min="0"
                    [(ngModel)]="invoice_technicians.allowance_hour1"
                    #allowance_hour1="ngModel"
                  />
                </div>
              </div>
              <!-- Price -->
              <div class="form-input">
                <label for="allowance_hour2">Allowance hour 2</label>
                <div class="input-field">
                  <input
                    type="number"
                    class="form-control"
                    id="allowance_hour2"
                    name="allowance_hour2"
                    min="0"
                    [(ngModel)]="invoice_technicians.allowance_hour2"
                    #allowance_hour2="ngModel"
                  />
                </div>
              </div>
              <div class="form-input">
                <label for="allowance_unit_price"
                  >Amount<span class="red-text">(*)</span></label
                >
                <div class="input-field">
                  <input
                    type="number"
                    class="form-control"
                    id="allowance_unit_price"
                    name="allowance_unit_price"
                    required
                    min="0"
                    [(ngModel)]="invoice_technicians.allowance_unit_price"
                    #allowance_unit_price="ngModel"
                  />
                </div>
              </div>
            </div>
          </div>
          <div
            class="col m12 s12 center"
            style="padding-top: 5px; padding-bottom: 5px"
          >
            <button
              type="button"
              class="waves-effect waves-light btn btn-small brown darken-3 center"
              [disabled]="disabledAssignTechnicianButton()"
              (click)="assignTechnician()"
            >
              <i class="material-icons">compare_arrows</i>
              Assign
            </button>
          </div>
          <div
            class="col m12 s12"
            style="border: 2px solid #757575; min-height: 100px"
          >
            <h5 class="center">List of technicians assign</h5>
            <table>
              <thead class="center">
                <tr>
                  <th>Name</th>
                  <th>Normal working hours (TS1/TS2/Unit price)</th>
                  <th>Overtime (TS1/TS2/Unit price)</th>
                  <th>Alowance(TS1/TS2/Unit price)</th>
                  <th></th>
                </tr>
              </thead>
              <tbody class="center">
                <tr *ngFor="let item of invoice_technician_list">
                  <td>{{ item.technician.name }}</td>
                  <td>
                    {{ item.normal_hour1 }} h /{{ item.normal_hour2 }} h /
                    {{ item.normal_unit_price }} h
                  </td>
                  <td>
                    {{ item.overtime_hour1 }} h /{{ item.overtime_hour2 }} h /
                    {{ item.overtime_unit_price }} h
                  </td>
                  <td>
                    {{ item.allowance_hour1 }} h /{{ item.allowance_hour2 }} h /
                    {{ item.allowance_unit_price }} h
                  </td>
                  <td>
                    <a
                      class="btn-flat red-text"
                      (click)="removeTechnicianToList(item)"
                      ><i class="material-icons">delete_forever</i></a
                    >
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="row">
          <h5 class="center">Extra information</h5>
          <hr />
          <div class="col m5 s12">
            <p>
              <label>
                <input
                  type="checkbox"
                  class="filled-in"
                  [checked]="hasHeading"
                  (change)="stateCheckedBoxheading($event)"
                />
                <span>Invoice has heading ?</span>
              </label>
            </p>
            <div class="form-input" *ngIf="hasHeading">
              <label for="heading"
                >Invoice heading <span class="red-text">(*)</span></label
              >
              <div class="input-field">
                <input
                  type="text"
                  class="form-control"
                  id="heading"
                  name="heading"
                  min="0"
                  [(ngModel)]="invoice.heading"
                  #heading="ngModel"
                  required
                />
              </div>
            </div>
            <br />
            <p>
              <label>
                <input
                  type="checkbox"
                  class="filled-in"
                  [checked]="isVAT"
                  (change)="stateCheckedBoxVat($event)"
                />
                <span>Add VAT (19.25%)</span>
              </label>
            </p>
            <br />
          </div>
          <div class="col m1 s12"></div>
          <div class="col m6 s12">
            <p>
              <label>
                <input
                  type="checkbox"
                  class="filled-in"
                  [checked]="hasPo"
                  (change)="stateCheckedBoxPo($event)"
                />
                <span>Invoice has purchase order ?</span>
              </label>
            </p>
            <div class="form-input" *ngIf="hasPo">
              <label for="purchase_order"
                >Purchase order <span class="red-text">(*)</span></label
              >
              <select
                class="browser-default"
                name="purchase_order"
                id="purchase_order"
                [(ngModel)]="invoice.purchase_order"
                [compareWith]="compareClient"
                required
                #purchase_order="ngModel"
              >
                <option [ngValue]="null" disabled>Select purchase order</option>
                <option *ngFor="let item of po" [ngValue]="item">
                  {{ item.reference }}
                </option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <!-- Submit button -->
      <div class="divider"></div>

      <div class="col s12 m12 center">
        <hr />
        <button
          type="submit"
          *ngIf="isAddForm"
          class="waves-effect waves-light btn"
          [disabled]="!clientForm.form.valid"
        >
          <i class="material-icons">save</i>
          Save
        </button>

        <button
          type="submit"
          *ngIf="!isAddForm"
          class="waves-effect waves-light btn"
        >
          Update
        </button>
      </div>
    </div>
  </div>
</form>
